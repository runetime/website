var about,About=function(){function t(){var t=document.querySelector("[data-dialog=clan-dialog-ads]"),e=document.querySelector("[data-dialog=clan-dialog-radio]"),s=document.querySelector("[data-dialog=clan-dialog-forums]"),n=document.querySelector("[data-dialog=clan-dialog-full-disclosure]"),o=document.querySelector("[data-dialog=clan-dialog-our-members]"),i=document.querySelector("[data-dialog=clan-dialog-community-openness]");this.setListen(t),this.setListen(e),this.setListen(s),this.setListen(n),this.setListen(o),this.setListen(i),console.log(1)}return t.prototype.setListen=function(t){if(t){var e=document.getElementById(t.getAttribute("data-dialog")),s=new DialogFx(e);t.addEventListener("click",s.toggle.bind(s))}},t}(),calculator,Calculator=function(){function t(t){this.calc=t,this.elements={},this.info={},this.URL={},this.items={},this.elements={currentXP:"#calculator-current-xp",displayName:"#calculator-display-name",submit:"#calculator-submit",table:"#calculator-table tbody",targetLevel:"#calculator-target-level"},this.URL={getCalc:"/calculators/load",getInfo:"/get/hiscore"},this.info={levelCurrent:0,levelTarget:0,XPCurrent:0,XPTarget:0},this.calculator=t,$(this.elements.submit).bind("click",function(){calculator.getInfo()}),this.loadCalc(),$("#calculator-target-level").keyup(function(){setTimeout(function(){calculator.updateCalc()},25)})}return t.prototype.calculateXP=function(t){var e=0,s=0;for(s=1;t>s;s+=1)e+=Math.floor(s+300*Math.pow(2,s/7));return Math.floor(e/4)},t.prototype.calculateLevel=function(t){var e=0,s=0;for(s=1;120>s;s+=1){if(e+=Math.floor(s+300+Math.pow(2,s/7)),Math.floor(e/4)>t)return s;if(s>=99)return 99}},t.prototype.getInfo=function(){var t=$(this.elements.displayName).val(),e=utilities.getAJAX(this.URL.getInfo+"/"+t);e.done(function(t){t=$.parseJSON(t);var e=t[13];calculator.info.levelCurrent=e[1],calculator.info.XPCurrent=e[2],$(calculator.elements.currentXP).val(calculator.info.XPCurrent),0===$(calculator.elements.targetLevel).val().length&&$(calculator.elements.targetLevel).val(parseInt(calculator.info.levelCurrent,10)+1),calculator.updateCalc()})},t.prototype.loadCalc=function(){var t={id:this.calculator},e=utilities.postAJAX(this.URL.getCalc,t);e.done(function(t){t=utilities.JSONDecode(t),calculator.items=t,$.each(calculator.items,function(t,e){var s="";s+="<tr>",s+="<td>"+calculator.items[t].name+"</td>",s+="<td>"+calculator.items[t].level+"</td>",s+="<td>"+calculator.items[t].xp+"</td>",s+="<td>&infin;</td>",s+="</tr>",$(calculator.elements.table).append(s)})})},t.prototype.updateCalc=function(){var t=0,e=0,s=0,n=0,o=0,i=0;this.info.levelTarget=parseInt($("#calculator-target-level").val()),console.log(this.info.levelTarget),this.info.XPTarget=this.calculateXP(this.info.levelTarget),this.info.XPCurrent>this.info.XPTarget&&(this.info.XPTarget=this.calculateXP(parseInt(this.info.levelCurrent,10)+1)),t=this.info.levelCurrent,e=this.info.levelTarget,s=this.info.XPCurrent,n=this.info.XPTarget,o=n-s,$.each(this.items,function(s,n){i=Math.ceil(o/calculator.items[s].xp),i=0>i?0:i,$(calculator.elements.table+" tr:nth-child("+(s+1)+") td:nth-child(4)").html(i),console.log(calculator.items[s].name),console.log(calculator.items[s].level),console.log(t),console.log(e),console.log(calculator.items[s].level),console.log("\n\n\n\n\n"),calculator.items[s].level<=t?$(calculator.elements.table+" tr:nth-child("+(s+1)+")").attr("class","text-success"):calculator.items[s].level>t&&e>=calculator.items[s].level?$(calculator.elements.table+" tr:nth-child("+(s+1)+")").attr("class","text-warning"):$(calculator.elements.table+" tr:nth-child("+(s+1)+")").attr("class","text-danger")})},t}(),chatbox,Chatbox=function(){function t(t){this.channel="#radio",this.elements={},this.lastId=0,this.messages=[],this.moderator=!1,this.pinned=[],this.spam={},this.times={},this.timeoutPinned=null,this.timeoutUpdate=null,this.URL={},this.pinnedDisplayed=[],this.channel=t,this.elements={actions:"#chatbox-actions",channels:"#chatbox-channels",chatbox:"#chatbox",error:"#chatbox-error",message:"#chatbox-message",messages:"#chatbox-messages"},this.URL={getStart:"/chat/start",getUpdate:"/chat/update",postMessage:"/chat/post/message",postStatusChange:"/chat/post/status/change"},this.spam={first:0,second:0,third:0},this.times={lastActivity:utilities.currentTime(),lastRefresh:utilities.currentTime(),loadedAt:utilities.currentTime()};var e=utilities.getAJAX("/chat/moderator");e.done(function(t){t=$.parseJSON(t),chatbox.moderator=t.mod===!0}),this.panelChat(),this.getStart(),$(this.elements.message).keypress(function(t){13===t.which&&chatbox.submitMessage()}),$(this.elements.channels).bind("click",function(){chatbox.panelChannels()}),setTimeout(function(){chatbox.update()},5e3),setTimeout(function(){chatbox.updateTimeAgo()},1e3)}return t.prototype.addMessage=function(t){this.lastId<t.id&&(this.lastId=t.id),t.status<=1&&(this.messages[this.messages.length]=t,this.times.lastActivity=utilities.currentTime())},t.prototype.displayMessage=function(e){if(e){var s="";s+=1===e.status?"<div id='"+e.id+"' class='msg msg-hidden'>":2===e.status?"<div id='"+e.id+"' class='msg msg-pinned'>":3===e.status?"<div id='"+e.id+"' class='msg msg-pinhid'>":"<div id='"+e.id+"' class='msg'>",s+="<time class='pull-right' data-ts='"+e.created_at+"'>",s+=utilities.timeAgo(e.created_at),s+="</time>",s+="<p>",chatbox.moderator===!0&&(s+=t.modTools(e)),s+="<a class='members-"+e.class_name+"'>"+e.author_name+"</a>: "+e.contents_parsed,s+="</p>",s+="</div>",$(chatbox.elements.messages).prepend(s)}},t.prototype.displayMessages=function(){var t=this.messages;$(this.elements.messages).html(""),$.each(t,function(t,e){chatbox.displayMessage(e)}),$.each(this.pinned,function(t,e){chatbox.pinnedDisplayed[e.id]!==!0&&(chatbox.pinnedDisplayed[e.id]=!0,chatbox.displayMessage(e))}),chatbox.pinnedDisplayed=[]},t.prototype.error=function(t){$(this.elements.error).html(t).fadeTo(1e3,1);var e=this;setTimeout(function(){$(e.elements.error).fadeTo(1e3,0),setTimeout(function(){$(e.elements.error).html("")},1500)},3500)},t.prototype.getStart=function(){$(this.elements.messages).html(""),this.messages=[];var t={time:this.times.loadedAt,channel:this.channel},e=utilities.postAJAX("chat/start",t),s=this;e.done(function(t){t=$.parseJSON(t),$.each(t.messages,function(t,e){s.addMessage(e)}),s.pinned=t.pinned,s.displayMessages()})},t.prototype.mod=function(t,e){var s={id:t,status:e},n=utilities.postAJAX("/chat/status-change",s);n.done(function(t){t=$.parseJSON(t),t.done===!0?chatbox.getStart():chatbox.error("There was an error while performing that moderation change.")})},t.modTools=function(t){var e="";return e+="<ul class='list-inline inline'>",e+="<li>",e+=t.status%2===0?"<a onclick='chatbox.mod("+t.id+", "+(t.status+1)+");' title='Hide message'><i class='fa fa-minus-circle text-info'></i></a>":"<a onclick='chatbox.mod("+t.id+", "+(t.status-1)+");' title='Show message'><i class='fa fa-plus-circle text-info'></i></a>",e+="</li>",e+="<li>",e+=t.status>=2?"<a onclick='chatbox.mod("+t.id+", "+(t.status-2)+");' title='Unpin message'><i class='fa fa-arrow-circle-down text-info'></i></a>":"<a onclick='chatbox.mod("+t.id+", "+(t.status+2)+");' title='Pin message'><i class='fa fa-arrow-circle-up text-info'></i></a>",e+="</li>",e+="</ul>"},t.prototype.panelChannels=function(){var t=utilities.getAJAX("/chat/channels");t.done(function(t){var e="";t=$.parseJSON(t),e+="<div id='chatbox-popup-channels'>",e+="<button type='button' class='close' onclick='chatbox.panelClose();'>Close <span aria-hidden='true'>&times;</span><span class='sr-only'>Close</span></button>",e+="<h3>Channels</h3>",e+="<p class='holo-text'>Currently on <b>#"+chatbox.channel+"</b></p>",$.each(t,function(t,s){e+="<a onclick=\"chatbox.switchChannel('"+s.name+"');\">#"+s.name+"</a><br />",e+="<span class='holo-text-secondary'>"+s.messages+" messages</span><br />",e+="<span class='holo-text-secondary'>Last active "+utilities.timeAgo(s.last_message)+"</span><br />"}),e+="</div>",$(chatbox.elements.messages).html(e)})},t.prototype.panelChat=function(){var t="";t+="<div id='chatbox-error'></div>",t+="<div id='chatbox-messages'></div>",t+="<div id='chatbox-actions'>",t+="<a href='/transparency/markdown' target='_blank' id='chatbox-markdown'>Markdown</a>",t+="<a id='chatbox-channels'>Channels</a>",t+="</div>",t+="<input type='text' id='chatbox-message' />",$(this.elements.chatbox).html(t)},t.prototype.panelClose=function(){this.getStart()},t.prototype.submitMessage=function(){var t,e,s=$(this.elements.message).val();if(t={contents:s,channel:this.channel},Date.now()/1e3-30<this.spam.third){var n=Date.now()/1e3-this.spam.third,o=Math.round(30-n);return void this.error("You must wait another "+o+" seconds before sending another message.")}this.spam.third=this.spam.second,this.spam.second=this.spam.first,this.spam.first=Date.now()/1e3,e=utilities.postAJAX(this.URL.postMessage,t);var i=this;e.done(function(t){t=$.parseJSON(t),i.update(),t.done===!0?($(i.elements.message).val(""),$(i.elements.message).toggleClass("message-sent"),setTimeout(function(){$(i.elements.message).toggleClass("message-sent")},1500)):($(i.elements.message).val(-1===t.error?"You are not logged in and can not send messages.":-2===t.error?"You were muted for one hour by a staff member and can not send messages.":"There was an unknown error.  Please try again."),$(i.elements.message).toggleClass("message-bad"),setTimeout(function(){$(i.elements.message).toggleClass("message-bad")},2500))})},t.prototype.switchChannel=function(t){var e,s;e={channel:t},s=utilities.postAJAX("/chat/channels/check",e),s.done(function(e){e=$.parseJSON(e),e.valid?(chatbox.channel=t,chatbox.getStart()):console.log("error")})},t.prototype.update=function(){var t={id:this.lastId,channel:this.channel},e=utilities.postAJAX(this.URL.getUpdate,t);e.done(function(t){t=$.parseJSON(t),chatbox.times.lastRefresh=utilities.currentTime(),t.length>0&&($.each(t,function(t,e){chatbox.addMessage(e)}),chatbox.displayMessages()),clearTimeout(chatbox.timeoutUpdate),chatbox.timeoutUpdate=setTimeout(function(){chatbox.update()},1e4)})},t.prototype.updateTimeAgo=function(){var t=$(this.elements.messages).find(".msg");$.each(t,function(t,e){var s=$(e).find("time").attr("data-ts");$(e).find("time").html(utilities.timeAgo(s))}),setTimeout(function(){chatbox.updateTimeAgo()},1e3)},t}(),clan,Clan=function(){function t(){var t=document.querySelector("[data-dialog=clan-dialog-warnings]"),e=document.querySelector("[data-dialog=clan-dialog-temporary-bans]"),s=document.querySelector("[data-dialog=clan-dialog-bans]");this.setListen(t),this.setListen(e),this.setListen(s)}return t.prototype.setListen=function(t){if(t){var e=document.getElementById(t.getAttribute("data-dialog")),s=new DialogFx(e);t.addEventListener("click",s.toggle.bind(s))}},t}();!function(t){"use strict";function e(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t}function s(t,s){this.el=t,this.options=e({},this.options),e(this.options,s),this.ctrlClose=this.el.querySelector("[data-dialog-close]"),this.isOpen=!1,this._initEvents()}var n={animations:Modernizr.cssanimations},o={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},i=o[Modernizr.prefixed("animation")],a=function(t,e){var s=function(t){if(n.animations){if(t.target!=this)return;this.removeEventListener(i,s)}e&&"function"==typeof e&&e.call()};n.animations?t.addEventListener(i,s):s()};s.prototype.options={onOpenDialog:function(){return!1},onCloseDialog:function(){return!1}},s.prototype._initEvents=function(){var t=this;this.ctrlClose.addEventListener("click",this.toggle.bind(this)),document.addEventListener("keydown",function(e){var s=e.keyCode||e.which;27===s&&t.isOpen&&t.toggle()}),this.el.querySelector(".dialog__overlay").addEventListener("click",this.toggle.bind(this))},s.prototype.toggle=function(){var t=this;this.isOpen?(classie.remove(this.el,"dialog--open"),classie.add(t.el,"dialog--close"),a(this.el.querySelector(".dialog__content"),function(){classie.remove(t.el,"dialog--close")}),this.options.onCloseDialog(this)):(classie.add(this.el,"dialog--open"),this.options.onOpenDialog(this)),this.isOpen=!this.isOpen},t.DialogFx=s}(window);var combatCalculator,CombatCalculator=function(){function t(){this.clicks={},this.generate={},this.inputs={},this.other={},this.paths={},this.clicks={submit:"[rt-data='combat.calculator:submit']"},this.generate={level:"[rt-data='combat.calculator:level']"},this.inputs={attack:"[rt-data='combat.calculator:attack']",defence:"[rt-data='combat.calculator:defence']",strength:"[rt-data='combat.calculator:strength']",constitution:"[rt-data='combat.calculator:constitution']",ranged:"[rt-data='combat.calculator:ranged']",prayer:"[rt-data='combat.calculator:prayer']",magic:"[rt-data='combat.calculator:magic']",summoning:"[rt-data='combat.calculator:summoning']"},this.other={name:"[rt-data='combat.calculator:name']"},this.paths={loadCombat:"/calculators/combat/load"},$(this.inputs.attack).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.defence).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.strength).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.constitution).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.ranged).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.prayer).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.magic).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.inputs.summoning).keyup(function(){setTimeout(function(){combatCalculator.updateLevel()},25)}),$(this.clicks.submit).click(function(){combatCalculator.getLevels()})}return t.prototype.getLevels=function(){var t=$(this.other.name).val(),e={rsn:t},s=utilities.postAJAX(this.paths.loadCombat,e);s.done(function(t){t=$.parseJSON(t),$(combatCalculator.inputs.attack).val(t.attack),$(combatCalculator.inputs.defence).val(t.defence),$(combatCalculator.inputs.strength).val(t.strength),$(combatCalculator.inputs.constitution).val(t.constitution),$(combatCalculator.inputs.ranged).val(t.ranged),$(combatCalculator.inputs.prayer).val(t.prayer),$(combatCalculator.inputs.magic).val(t.magic),$(combatCalculator.inputs.summoning).val(t.summoning),combatCalculator.updateLevel()})},t.prototype.updateLevel=function(){var t=this.val("attack")+this.val("strength"),e=2*this.val("magic"),s=2*this.val("ranged"),n=this.val("defence")+this.val("constitution"),o=.5*this.val("prayer")+.5*this.val("summoning"),i=1.3*Math.max(t,e,s)+n+o;i*=.25,i=Math.floor(i),$(this.generate.level).html(i)},t.prototype.val=function(t){return parseInt($("[rt-data='combat.calculator:"+t+"']").val())},t}(),contact,Contact=function(){function t(){this.data={},this.elements={},this.hooks={},this.paths={},this.data={sent:!1},this.elements={email:"#contact-email",error:"#contact-error",message:"#contact-message",username:"#contact-username"},this.hooks={submit:"[rt-hook='contact:submit']"},this.paths={form:"/contact/submit"},$(this.hooks.submit).click(function(){contact.send()})}return t.prototype.done=function(t){$(this.elements.error).html(t),$(this.elements.error).removeClass().addClass("text-success")},t.prototype.error=function(t){$(this.elements.error).html(t),$(this.elements.error).removeClass().addClass("text-danger")},t.prototype.send=function(){if(this.data.sent===!0)return this.done("You have already sent your message!");var t=$(this.elements.email).val(),e=$(this.elements.message).val(),s=$(this.elements.username).val();if(this.validateEmail(t)===!1)return this.error("That is not a validate email address.");var n={contents:e,email:t,username:s},o=utilities.postAJAX(this.paths.form,n);this.warning("Sending message..."),o.done(function(t){t=$.parseJSON(t),t.done===!0?(contact.data.sent=!0,contact.done("Your message has been sent.")):contact.error("There was an unknown error while sending your message.")})},t.prototype.validateEmail=function(t){var e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)},t.prototype.warning=function(t){$(this.elements.error).html(t),$(this.elements.error).removeClass().addClass("text-warning")},t}(),forums,Forums=function(){function t(){this.elements={},this.hooks={},this.paths={},this.post=null,this.threadCreate=null,this.elements={postEditor:"[rt-data='post.edit']"},this.hooks={poll:{vote:"[rt-hook='forum:poll.vote']"}},this.paths={poll:{vote:"/forums/poll/vote"},vote:function(t){return"/forums/post/"+t+"/vote"}},this.post=new Post,$(".upvote").bind("click",function(t){var e=$(t.target).parent().parent().parent().parent().parent().attr("id");forums.upvote(e)}),$(".downvote").bind("click",function(t){var e=$(t.target).parent().parent().parent().parent().parent().attr("id");forums.downvote(e)}),$("[rt-hook='forums.thread.post:quote']").bind("click",function(t){var e=$(t.target).attr("rt-data");forums.post.quote(e)}),$(this.hooks.poll.vote).click(function(t){var e=$(t.target).attr("rt-data");e=$.parseJSON(e),forums.pollVote(e.question,e.answer)})}return t.prototype.downvote=function(t){t=t.replace("post","");var e=$("#post"+t),s=$(e).hasClass("upvote-active"),n=$(e).hasClass("downvote-active");n===!0?$(e).removeClass("downvote-active"):$(e).addClass("downvote-active"),s===!0&&$(e).removeClass("upvote-active");var o={vote:"down"},i=utilities.postAJAX(this.paths.vote(t),o);i.done(function(t){t=$.parseJSON(t)})},t.prototype.pollVote=function(t,e){var s={answer:e,question:t},n=utilities.postAJAX(this.paths.poll.vote,s);n.done(function(t){t=$.parseJSON(t),t.done===!0?window.location.replace(window.location.pathname):-1===t.error})},t.prototype.upvote=function(t){t=t.replace("post","");var e=$("#post"+t),s=$(e).hasClass("upvote-active"),n=$(e).hasClass("downvote-active");s===!0?$(e).removeClass("upvote-active"):$(e).addClass("upvote-active"),n===!0&&$(e).removeClass("downvote-active");var o={vote:"up"},i=utilities.postAJAX(this.paths.vote(t),o);i.done(function(t){t=$.parseJSON(t)})},t}(),Post=function(){function t(){}return t.prototype.quote=function(t){var e=$("[rt-data='post#"+t+":source']").html(),s=$(forums.elements.postEditor).val();e=e.replace(/\n/g,"\n>"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=">"+e,s.length>0&&(s+="\n"),$(forums.elements.postEditor).val(s+e+"\n"),utilities.scrollTo($(forums.elements.postEditor),1e3),$(forums.elements.postEditor).focus()},t}(),ForumsThreadCreate=function(){function t(){this.hooks={},this.questions=[],this.values={},this.views={},this.hooks={questionAdd:"[rt-hook='forums.thread.create:poll.question.add']",questions:"[rt-hook='forums.thread.create:poll.questions']"},this.questions=Array(500),this.values={questions:0},this.views={answer:$("[rt-view='forums.thread.create:poll.answer']").html(),question:$("[rt-view='forums.thread.create:poll.question']").html()},$(this.hooks.questionAdd).bind("click",function(){forums.threadCreate.addQuestion()})}return t.prototype.addQuestion=function(){var t=this.views.question;$(this.hooks.questions).append(t),this.values.questions+=1},t.prototype.removeQuestion=function(t){this.questions.splice(t,1)},t.prototype.setListener=function(t,e){"remove question"===e&&this.setListenerRemoveQuestion(t)},t.prototype.setListenerRemoveQuestion=function(t){$(t).bind("click",function(e){forums.threadCreate.removeQuestion($(t).parent().parent().attr("rt-data"))})},t}();$(function(){forums=new Forums});var LivestreamReset=function(){function t(){this.hooks={},this.lang={},this.paths={},this.hooks={note:"[rt-hook='livestream.reset:note']",spinner:"[rt-hook='livestream.reset:spinner']",status:"[rt-hook='livestream.reset:status']"},this.lang={checking:"checking",offline:"offline",online:"online",unknown:"unknown"},this.paths={reset:"/livestream/reset"},this.reset()}return t.prototype.reset=function(){$("#loading").css({opacity:1});var t=utilities.postAJAX(this.paths.reset,{});t.done(function(t){t=utilities.JSONDecode(t),t.online===!0?livestreamReset.statusOnline():t.online===!1?livestreamReset.statusOffline():livestreamReset.statusUnknown(),livestreamReset.spinnerRemove()}),$("#loading").css({opacity:0})},t.prototype.spinnerRemove=function(){$(this.hooks.spinner).css({opacity:0})},t.prototype.statuses=function(t,e,s,n){this.lang.checking=t,this.lang.offline=s,this.lang.online=e,this.lang.unknown=n},t.prototype.statusOffline=function(){$(this.hooks.status).html("offline").removeClass().addClass("text-danger")},t.prototype.statusOnline=function(){$(this.hooks.status).html("online").removeClass().addClass("text-success")},t.prototype.statusUnknown=function(){$(this.hooks.status).html("unknown").removeClass().addClass("text-warning")},t}(),runetime,RuneTime=function(){function t(){this.loading="#loading"}return t}();runetime=new RuneTime,$(function(){"use strict";$("[data-toggle]").tooltip(),$(".dropdown-toggle").dropdown(),$("tbody.rowlink").rowlink(),$("#top").click(function(){$("html, body").animate({scrollTop:0},1e3)}),$(window).scroll(function(){var t=$("body").height(),e=$(window).scrollTop(),s=$("#top");e>t/10?$(s).hasClass("set-vis")||$(s).fadeIn(200).toggleClass("set-vis"):$(s).hasClass("set-vis")&&$(s).fadeOut(200).toggleClass("set-vis")}),$(".navbar .dropdown").hover(function(){$(this).find(".dropdown-menu").first().stop(!0,!0).delay(50).slideDown()},function(){$(this).find(".dropdown-menu").first().stop(!0,!0).delay(100).slideUp()})});var toggleSearch;$(function(){function t(t,e,s){var n="<a class='media-object' href='"+s+"'>";return t.length>0&&(n+="<img src='"+t+"' />"),n+="<h3>"+e+"</h3>",n+="</a>"}var e=document.getElementById("morphsearch"),s=e.querySelector("input.morphsearch-input"),n=e.querySelector("span.morphsearch-close"),o=!1;toggleSearch=function(t){morphsearch.getBoundingClientRect();"close"===t?(classie.remove(e,"open"),""!==s.value&&setTimeout(function(){classie.add(e,"hideInput"),setTimeout(function(){classie.remove(e,"hideInput"),s.value=""},300)},500),s.blur()):classie.add(e,"open"),o=!o},n.addEventListener("click",toggleSearch),document.addEventListener("keydown",function(t){var e=t.keyCode||t.which;27===e&&o&&toggleSearch(t)});var i=function(){var e=$("input.morphsearch-input").val();if(0!==e.length){var s={contents:e},n=utilities.postAJAX("/search",s);n.done(function(e){e=$.parseJSON(e),$("#search-people").html("<h2>People</h2>"),$("#search-threads").html("<h2>Threads</h2>"),$("#search-news").html("<h2>News</h2>"),$.each(e.users,function(){var e=t(this.img,this.name,this.url);$("#search-people").append(e)}),$.each(e.threads,function(){var e=t(this.img,this.name,this.url);$("#search-threads").append(e)}),$.each(e.news,function(){var e=t(this.img,this.name,this.url);$("#search-news").append(e)})})}},a=e.querySelector('button[type="submit"]');a.addEventListener("click",function(t){t.preventDefault(),i()}),$(".morphsearch-input").bind("keydown",function(t){13===t.keyCode&&(t.preventDefault(),i())})}),$(function(){$("#search-glass").click(function(){{var t=$("#morphsearch");$(".morphsearch-input")}"none"==$(t).css("display")?$(t).css("display","block"):$(t).css("display","none"),toggleSearch("focus")}),$(".morphsearch-close").click(function(){var t=$("#morphsearch");$(t).animate({opacity:0},500),setTimeout(function(){toggleSearch("close")},500),setTimeout(function(){$("#morphsearch").css({opacity:1}),$(".morphsearch").css({display:"none"})},1e3)})});var nameChecker,NameChecker=function(){function t(){this.elements={},this.form={},this.notAllowed=[],this.paths={},this.elements={availability:"#rsn-availability",check:"#rsn-check-field"},this.notAllowed=["ZnVjaw==","c2hpdA=="],this.paths={check:"/name-check"},this.setForm()}return t.prototype.setForm=function(){this.form=document.getElementById("namechecker-form"),new stepsForm(this.form,{onSubmit:function(){var t=$("#q1").val(),e={rsn:t},s=utilities.postAJAX(nameChecker.paths.check,e);s.done(function(e){var s=nameChecker.form.querySelector(".simform-inner");classie.addClass(s,"hide");var n=nameChecker.form.querySelector(".final-message"),o="The Runescape name <b>"+t+"</b> is ";o+="<!DOCT"===e.substring(0,6)?"available.":"unavailable.",o+="<br /><a href='/name-check' class='btn btn-primary'>Search Again</a>",n.innerHTML=o,classie.addClass(n,"show")})}})},t}(),news,News=function(){function t(){this.elements={},this.hooks={},this.paths={},this.elements={comment:{contents:"#news-comment-textarea"}},this.hooks={comment:{submit:"[rt-hook='news.article:comment.submit']"}},this.paths={comment:function(t){return"/news/"+t+"-name/reply"}};var t=document.getElementById("overlay"),e=t.querySelector("button"),s=document.getElementById("header"),n=s.querySelector("button.slider-switch"),o=function(){r.isFullscreen?classie.add(n,"view-maxi"):classie.remove(n,"view-maxi")},i=function(){r.isContent||classie.add(s,"hide")},a=function(){r.isContent||classie.remove(s,"hide")},r=new DragSlideshow(document.getElementById("slideshow"),{onToggle:o,onToggleContent:i,onToggleContentComplete:a}),l=function(){r.toggle(),o()},c=function(){classie.add(t,"hide")};if(n.addEventListener("click",l),e.addEventListener("click",c),localStorage){var u=localStorage.getItem("news.info.showed");"true"===u&&c()}this.setupActions()}return t.prototype.setupActions=function(){$("div.info button").click(function(){localStorage&&localStorage.setItem("news.info.showed","true")}),$(this.hooks.comment.submit).click(function(t){var e=$(t.target).parent().attr("rt-data"),s=$(t.target).parent().find("textarea").val();news.submitComment(e,s)})},t.prototype.submitComment=function(t,e){if(0==e.length)return 0;var s={contents:e},n=utilities.postAJAX(this.paths.comment(t),s);n.done(function(t){t=$.parseJSON(t),t.done===!0&&(window.location.href=t.url)})},t.prototype.toComments=function(t){$("[data-content='content-"+t+"'] button.content-switch").trigger("click")},t}(),Notifications=function(){function t(){this.elements={},this.paths={},this.paths={markRead:"/notifications/mark-read"},$("[rt-hook='hook!notifications:mark.read']").bind("click",function(t){console.log(t.target.attr("rt-data"))})}return t}(),radio,chatbox,Radio=function(){function t(){this.elements={},this.online=!0,this.popup=null,this.status=!1,this.statusClosed="",this.statusOpen="",this.URL="",this.varMessage="",this.varStatus="",this.URL="http://apps.streamlicensing.com/player-popup.php?sid=2579&stream_id=4386",this.statusClosed="to listen to RuneTime Radio!",this.statusOpen="to close RuneTime Radio",this.varMessage="#radio-message",this.varStatus="#radio-status",this.update(),this.elements={statusMessage:"#radio-status-message"},$("#radio-history").click(function(){radio.openHistory()}),$("#radio-request").click(function(){radio.requestOpen()}),$("#radio-timetable").click(function(){radio.openTimetable()}),$("#request-button").click(function(){}),$("#pull-close").click(function(){radio.pullHide()})}return t.prototype.openHistory=function(){var t=utilities.getAJAX("radio/history");t.done(function(t){t=$.parseJSON(t);for(var e=null,s="<table class='table'><thead><tr><td>Time</td><td>Artist</td><td>Name</td></tr></thead><tbody>",n=0,o=t.length;o>n;n++)e=t[n],s+="<tr><td>"+utilities.timeAgo(e.created_at)+"</td><td> "+e.artist+"</td><td>"+e.song+"</td></tr>";s+="</tbody></table>",radio.pullOpen(s)})},t.prototype.openTimetable=function(){var t=utilities.getAJAX("radio/timetable");t.done(function(t){t=$.parseJSON(t);for(var e="<table class='table text-center'><thead><tr><td>&nbsp;</td><td>Monday</td><td>Tuesday</td><td>Wednesday</td><td>Thursday</td><td>Friday</td><td>Saturday</td><td>Sunday</td></tr></thead><tbody>",s=0,n=23;n>=s;s++){e+="<tr><td>"+s+":00</td>";for(var o=0,i=6;i>=o;o++)e+="<td>",e+=void 0!==t[o]&&void 0!==t[o][s]?t[o][s]:"&nbsp;",e+="</td>";e+="</tr>"}e+="</tbody></table>",radio.pullOpen(e)})},t.prototype.onlineSettings=function(t){this.online=t,t!==!0?($(this.elements.statusMessage).html("The radio has been set offline."),$(this.varStatus).removeClass().addClass("text-danger").html("<i id='power-button' class='fa fa-power-off'></i>Off")):($(this.elements.statusMessage).html(""),$(this.varStatus).removeClass().addClass("text-success").html("<i id='power-button' class='fa fa-power-off'></i>On"))},t.prototype.pullHide=function(){$("#pull-contents").html("&nbsp;"),$("#radio-pull").width("").addClass("hidden").css({width:"0%"}),$("#radio-options").width("").css({width:"100%"})},t.prototype.pullOpen=function(t){$("#pull-contents").html(t),$("#radio-pull").removeClass("hidden").css({width:"50%"}),$("#radio-options").css({width:"50%"})},t.prototype.requestOpen=function(){var t=utilities.getAJAX("radio/request/song");t.done(function(t){t=$.parseJSON(t);var e="";e+=2===t.response?"<form role='form'><div class='form-group'><label for='request-artist'>Artist Name</label><input type='text' id='request-artist' class='form-control' name='request-artist' placeholder='Artist Name' required /></div><div class='form-group'><label for='request-name'>Song Name</label><input type='text' id='request-name' class='form-control' name='request-name' placeholder='Song Name' required /></div><div class='form-group'><p id='request-button' class='btn btn-primary'>Request</p></div></form>":1===t.response?"<p class='text-warning'>Auto DJ currently does not accept song requests, sorry!":"<p class='text-danger'>You must be logged in to request a song from the DJ.</p>",radio.pullOpen(e)}),setTimeout(function(){$("#request-button").click(function(){radio.requestSend()})},3e3)},t.prototype.requestSend=function(){var t={artist:document.getElementById("request-artist").value,name:document.getElementById("request-name").value},e=utilities.postAJAX("radio/request/song",t);e.done(function(t){t=$.parseJSON(t);var e="";e=t.sent===!0?"<p class='text-success'>Your request has been sent to the DJ</p>":"<p class='text-danger'>There was an error while processing your request.  Try again?",$("#pull-contents").html(e)}),this.pullHide(),this.update()},t.prototype.update=function(){$("#requests-user-current").html("");var t=utilities.getAJAX("radio/update");t.done(function(t){t=$.parseJSON(t);var e="";$("#radio-song-name").html(t.song.name),$("#radio-song-artist").html(t.song.artist),$("#radio-dj").html(null!==t.dj&&""!==t.dj?"DJ "+t.dj:"Auto DJ"),$("[rt-data='radio:message.contents']").html(""!==t.message&&-1!==t.message?t.message:-1===t.message&&null!==t.dj&&""!==t.dj?"DJ "+t.dj+" is currently on air!":"Auto DJ is currently on air");for(var s=0,n=t.requests.length;n>s;s++){var o=t.requests[s];0==o.status?e+="<p>":1==o.status?e+="<p class='text-success'>":2==o.status&&(e+="<p class='text-danger'>"),e+=o.song_name+" by "+o.song_artist,e+="</p>"}$("#requests-user-current").html(e),radio.onlineSettings(t.online),setTimeout(function(){radio.update()},3e4)})},t}(),signature,Signature=function(){function t(){this.paths={},this.paths={submit:"/signatures"};var t=document.getElementById("signature-form");new stepsForm(t,{onSubmit:function(){var t=$("#q1").val(),e={username:t};utilities.post(signature.paths.submit,e)}})}return t}(),signupForm,SignupForm=function(){function t(){this.elements={},this.paths={},this.elements={displayName:"#display_name",email:"#email",password:"#password",password2:"#password2",securityCheck:"#security"},this.paths={checkAvailability:"/get/signup/"};var t,e,s,n=500;$(this.elements.displayName).bind("input",function(){t&&clearTimeout(t),t=setTimeout(function(){signupForm.checkAvailability("display_name")},n)}),$(this.elements.email).bind("input",function(){e&&clearTimeout(e),e=setTimeout(function(){signupForm.checkAvailability("email")},n)}),$(this.elements.password).bind("input",function(){s&&clearTimeout(s),s=setTimeout(function(){signupForm.checkPassword()},n)}),$(this.elements.password2).bind("input",function(){
s&&clearTimeout(s),s=setTimeout(function(){signupForm.checkPassword()},n)}),$(this.elements.securityCheck).bind("change",function(){signupForm.checkSecurity()}),$("form").submit(function(t){signupForm.submit(t)})}return t.prototype.checkAvailability=function(t){var e=$("#"+t).val();if(0===e.length)return!1;var s,n=this.paths.checkAvailability+t;"display_name"===t?s=utilities.postAJAX(n,{display_name:e}):"email"===t&&(s=utilities.postAJAX(n,{email:e})),s.done(function(e){return e=utilities.JSONDecode(e),e.available===!0?($("#signup-"+t).removeClass("has-error").addClass("has-success").find(".col-lg-10").find(".help-block").removeClass("show").addClass("hidden").parent().find(".glyphicon-ok").removeClass("hidden").addClass("show").parent().find(".glyphicon-remove").removeClass("show").addClass("hidden"),!0):($("#signup-"+t).removeClass("has-success").addClass("has-error").find(".col-lg-10").find(".help-block").removeClass("hidden").addClass("show").parent().find(".glyphicon-remove").removeClass("hidden").addClass("show").parent().find(".glyphicon-ok").removeClass("show").addClass("hidden"),!1)})},t.prototype.checkPassword=function(){var t=$(this.elements.password).val(),e=$(this.elements.password2).val();return e.length>0?t===e?(this.toggleFeedback("password",!0),this.toggleFeedback("password2",!0),!0):(this.toggleFeedback("password",!1),this.toggleFeedback("password2",!1),!1):void 0},t.prototype.checkSecurity=function(){var t=$(this.elements.securityCheck).val();10>=t?($("form button").removeAttr("disabled"),$("form .text-danger").css({display:"none"})):t>10&&($("form button").attr("disabled","disabled"),$("form .text-danger").css({display:"block"}))},t.prototype.submit=function(t){var e=this.checkAvailability("username"),s=this.checkAvailability("email"),n=this.checkPassword();return e===!0&&s===!0&&n===!0?(t.preventDefault(),!0):void t.preventDefault()},t.prototype.toggleFeedback=function(t,e){e===!0?$("#signup-"+t).removeClass("has-error").addClass("has-success").find(".col-lg-10").find(".glyphicon-ok").removeClass("hidden").addClass("show").parent().find(".glyphicon-remove").removeClass("show").addClass("hidden").parent().find(".help-block").removeClass("show").addClass("hidden"):$("#signup-"+t).removeClass("has-success").addClass("has-error").find(".col-lg-10").find(".glyphicon-remove").removeClass("hidden").addClass("show").parent().find(".glyphicon-ok").removeClass("show").addClass("hidden").parent().find(".help-block").removeClass("hidden").addClass("show")},t}(),StaffList=function(){function t(){var t=$("[rt-hook='hook!staff.list:card']");$.each(t,function(t,e){var s=$(e),n=$(s).attr("rt-data"),o="";o="no"==n?$(s).attr("rt-data2"):n,$(s).find(".front").css({"background-image":"url('/img/forums/photos/"+o+".png')"}),$(s).bind("touchstart",function(){$(this).toggleClass("hover")})})}return t}();!function(t){"use strict";function e(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t}function s(t,s){this.el=t,this.options=e({},this.options),e(this.options,s),this._init()}var n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},o=n[Modernizr.prefixed("transition")],i={transitions:Modernizr.csstransitions};s.prototype.options={onSubmit:function(){return!1}},s.prototype._init=function(){this.current=0,this.questions=[].slice.call(this.el.querySelectorAll("ol.questions > li")),this.questionsCount=this.questions.length,classie.addClass(this.questions[0],"current"),this.ctrlNext=this.el.querySelector("button.next"),this.progress=this.el.querySelector("div.progress"),this.questionStatus=this.el.querySelector("span.number"),this.currentNum=this.questionStatus.querySelector("span.number-current"),this.currentNum.innerHTML=Number(this.current+1),this.totalQuestionNum=this.questionStatus.querySelector("span.number-total"),this.totalQuestionNum.innerHTML=this.questionsCount,this.error=this.el.querySelector("span.error-message"),this._initEvents()},s.prototype._initEvents=function(){var t=this,e=this.questions[this.current].querySelector("input"),s=function(){e.removeEventListener("focus",s),classie.addClass(t.ctrlNext,"show")};e.addEventListener("focus",s),this.ctrlNext.addEventListener("click",function(e){e.preventDefault(),t._nextQuestion()}),document.addEventListener("keydown",function(e){var s=e.keyCode||e.which;13===s&&(e.preventDefault(),t._nextQuestion())}),this.el.addEventListener("keydown",function(t){var e=t.keyCode||t.which;9===e&&t.preventDefault()})},s.prototype._nextQuestion=function(){if(!this._validade())return!1;this.current===this.questionsCount-1&&(this.isFilled=!0),this._clearError();var t=this.questions[this.current];if(++this.current,this._progress(),!this.isFilled){this._updateQuestionNumber(),classie.addClass(this.el,"show-next");var e=this.questions[this.current];classie.removeClass(t,"current"),classie.addClass(e,"current")}var s=this,n=function(t){i.transitions&&this.removeEventListener(o,n),s.isFilled?s._submit():(classie.removeClass(s.el,"show-next"),s.currentNum.innerHTML=s.nextQuestionNum.innerHTML,s.questionStatus.removeChild(s.nextQuestionNum),e.querySelector("input").focus())};i.transitions?this.progress.addEventListener(o,n):n()},s.prototype._progress=function(){this.progress.style.width=this.current*(100/this.questionsCount)+"%"},s.prototype._updateQuestionNumber=function(){this.nextQuestionNum=document.createElement("span"),this.nextQuestionNum.className="number-next",this.nextQuestionNum.innerHTML=Number(this.current+1),this.questionStatus.appendChild(this.nextQuestionNum)},s.prototype._submit=function(){this.options.onSubmit(this.el)},s.prototype._validade=function(){var t=this.questions[this.current].querySelector("input").value;return""===t?(this._showError("EMPTYSTR"),!1):!0},s.prototype._showError=function(t){var e="";switch(t){case"EMPTYSTR":e="Please fill the field before continuing";break;case"INVALIDEMAIL":e="Please fill a valid email address"}this.error.innerHTML=e,classie.addClass(this.error,"show")},s.prototype._clearError=function(){classie.removeClass(this.error,"show")},t.stepsForm=s}(window);var utilities,Utilities=function(){function t(){}return t.prototype.currentTime=function(){return Math.floor(Date.now()/1e3)},t.prototype.formToken=function(t){t=atob(t),$("form").append("<input type='hidden' name='_token' value='"+t+"' />");var e=document.createElement("meta");e.name="_token",e.content=t,document.getElementsByTagName("head")[0].appendChild(e)},t.prototype.getAJAX=function(t){return $.ajax({url:t,type:"get",dataType:"html",async:!0})},t.prototype.JSONDecode=function(t){return $.parseJSON(t)},t.prototype.postAJAX=function(t,e){return e._token=$('meta[name="_token"]').attr("content"),$.ajax({url:t,type:"post",data:e,async:!0})},t.prototype.scrollTo=function(t,e){$("html, body").animate({scrollTop:$(t).offset().top},e)},t.prototype.timeAgo=function(t){var e=Math.floor(Date.now()/1e3),s=e-t;return s>172800?"a few days ago":s>86400?"yesterday":s>7200?Math.floor(s/3600)+" hours ago":s>3600?"an hour ago":s>=120?Math.floor(s/60)+" minutes ago":s>=60?"1 minute ago":s>1?s+" seconds ago":"1 second ago"},t.prototype.post=function(t,e,s){s=s||"post";var n=document.createElement("form");n.setAttribute("method",s),n.setAttribute("action",t);for(var o in e)if(e.hasOwnProperty(o)){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",o),i.setAttribute("value",e[o]),n.appendChild(i)}var a=$("meta[name='_token']").attr("content"),r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","_token"),r.setAttribute("value",a),n.appendChild(r),document.body.appendChild(n),n.submit()},t}();utilities=new Utilities;