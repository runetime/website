var adminPanel,AdminPanel=function(){function a(){this.elements={},this.hooks={},this.paths={},this.elements={ipBan:{ip:"#ip-ban-address",reason:"#ip-ban-reason"},modals:{chatboxClear:"#modal-chatbox-clear",ipBan:"#modal-ip-ban",radioStop:"#modal-radio-stop",staffDemote:"#modal-staff-demote"},results:{good:"#modal-results-good",goodMessage:"[rt-hook='modal:good.message']",bad:"#modal-results-bad",badMessage:"[rt-hook='modal:bad.message']"}},this.hooks={chatbox:{clear:{confirm:"[rt-hook='admin.panel:chatbox.clear.confirm']",open:"[rt-hook='admin.panel:chatbox.clear.open']"}},ip:{ban:{confirm:"[rt-hook='admin.panel:ip.ban.confirm']",open:"[rt-hook='admin.panel:ip.ban.open']"}},radio:{stop:{confirm:"[rt-hook='admin.panel:radio.stop.confirm']",open:"[rt-hook='admin.panel:radio.stop.open']"}},staff:{demote:{confirm:"[rt-hook='admin.panel:staff.demote.confirm']",open:"[rt-hook='admin.panel:staff.demote.open']"}}},this.paths={chatbox:{clear:"/staff/leader/chatbox-clear"},ip:{ban:"/staff/administrator/ip-ban"},radio:{stop:"/staff/administrator/radio-stop"},staff:{demote:"/staff/administrator/staff-demote"}},$(this.hooks.chatbox.clear.open).click(function(){$(adminPanel.elements.modals.chatboxClear).modal("show")}),$(this.hooks.ip.ban.open).click(function(){$(adminPanel.elements.modals.ipBan).modal("show")}),$(this.hooks.radio.stop.open).click(function(){$(adminPanel.elements.modals.radioStop).modal("show")}),$(this.hooks.staff.demote.open).click(function(){$(adminPanel.elements.modals.staffDemote).modal("show")}),$(this.hooks.chatbox.clear.confirm).click(function(){adminPanel.chatboxClear()}),$(this.hooks.ip.ban.confirm).click(function(){adminPanel.ban()}),$(this.hooks.radio.stop.confirm).click(function(){adminPanel.radioStop()}),$(this.hooks.staff.demote.confirm).click(function(){adminPanel.staffDemote()})}return a.prototype.ban=function(){var a=$(this.elements.ipBan.ip).val(),b=$(this.elements.ipBan.reason).val(),c={ip:a,contents:b},d=utilities.postAJAX(this.paths.ip.ban,c);d.done(function(a){a=$.parseJSON(a),a.done===!0?adminPanel.done("The IP has been successfully banned."):adminPanel.error("There was an unknown error while performing the IP ban.")})},a.prototype.chatboxClear=function(){var a=utilities.postAJAX(this.paths.chatbox.clear,{});a.done(function(a){a=$.parseJSON(a),a.done===!0?adminPanel.done("The chatbox was successfully cleared."):adminPanel.error("There was an unknown error while clearing the chatbox.")})},a.prototype.done=function(a){$.each(this.elements.modals,function(a,b){$(b).modal("hide")}),$(this.elements.results.good).modal("show"),$(this.elements.results.goodMessage).html(a)},a.prototype.error=function(a){$.each(this.elements.modals,function(a,b){$(b).modal("hide")}),$(this.elements.results.bad).modal("show"),$(this.elements.results.badMessage).html(a)},a.prototype.radioStop=function(){var a=utilities.postAJAX(this.paths.radio.stop,{});a.done(function(a){a=$.parseJSON(a),a.done===!0?adminPanel.done("The radio will successfully stop within 30 seconds."):adminPanel.error("There was an unknown error while stopping the radio.")})},a.prototype.staffDemote=function(){var a=utilities.postAJAX(this.paths.staff.demote,{});a.done(function(a){a=$.parseJSON(a),a.done===!0?adminPanel.done("All staff were successfully demoted."):adminPanel.error("There was an unknown error while demoting all staff.")})},a}(),userPanel,AdminUserPanel=function(){function a(){this.elements={},this.hooks={},this.paths={},this.elements={award:{id:"#award-add-id",username:"#award-add-username"},ban:{},banIp:{address:"#ip-ban-address",reason:"#ip-ban-reason"},chatbox:{reason:"#chatbox-remove-reason",username:"#chatbox-remove-username"},modals:{award:"#modal-award-add",ban:"#modal-ban",chatboxRemove:"#modal-chatbox-remove",ipBan:"#modal-ip-ban",mute:"#modal-mute-user",postsRemove:"#modal-posts-remove"},modalResults:{bad:"#modal-results-bad",good:"#modal-results-good"},mute:{reason:"#mute-reason",time:"#mute-time",username:"#mute-username"},posts:{reason:"#posts-remove-reason",username:"#posts-remove-username"},search:{list:"#admin-user-list",name:"#admin-user-search"}},this.hooks={listing:{awardAdd:"[rt-hook='admin.panel:user.award.add']",chatboxRemove:"[rt-hook='admin.panel:user.chatbox.remove']",postsRemove:"[rt-hook='admin.panel:user.posts.remove']",userBan:"[rt-hook='admin.panel:user.ban']",userBanPermanent:"[rt-hook='admin.panel:user.ban.permanent']",userMute:"[rt-hook='admin.panel:user.mute']"},modals:{results:{bad:"[rt-hook='modal:bad.message']",good:"[rt-hook='modal:good.message']"}},search:{submit:"[rt-hook='admin.panel:user.search']"},submit:{award:"[rt-hook='admin.panel:user.award.add.confirm']",chatbox:"[rt-hook='admin.panel:user.chatbox.remove.confirm']",ip:"[rt-hook='admin.panel:ip.ban.confirm']",mute:"[rt-hook='leader.panel:mute.submit']",posts:"[rt-hook='admin.panel:user.posts.remove.confirm']"}},this.paths={award:"/staff/administrator/users/award-add",awardList:"/api/v1/awards",chatboxRemove:"/staff/administrator/users/chatbox-remove",ip:"/staff/administrator/ip-ban",mute:"/staff/leader/mute",posts:"/staff/administrator/users/forum-posts",search:"/staff/administrator/users/search",username:"/api/v1/user"},$(this.hooks.search.submit).click(function(){userPanel.search()}),$(this.hooks.submit.award).click(function(){userPanel.awardSubmit()}),$(this.hooks.submit.chatbox).click(function(){userPanel.chatboxSubmit()}),$(this.hooks.submit.ip).click(function(){userPanel.banIpSubmit()}),$(this.hooks.submit.posts).click(function(){userPanel.postsSubmit()}),$(this.hooks.submit.mute).click(function(){userPanel.muteSubmit()})}return a.prototype.addEvents=function(){$(this.hooks.listing.awardAdd).click(function(a){var b=$(a.target).parent().parent().parent().attr("rt-data"),c=userPanel.getUsernameById(b);c.done(function(a){a=$.parseJSON(a),$(userPanel.elements.award.username).val(a.display_name)}),userPanel.getAwards(),$(userPanel.elements.modals.award).modal("show")}),$(this.hooks.listing.chatboxRemove).click(function(a){var b=$(a.target).parent().parent().parent().attr("rt-data"),c=userPanel.getUsernameById(b);c.done(function(a){a=$.parseJSON(a),$(userPanel.elements.chatbox.username).val(a.display_name)}),$(userPanel.elements.modals.chatboxRemove).modal("show")}),$(this.hooks.listing.postsRemove).click(function(a){var b=$(a.target).parent().parent().parent().attr("rt-data"),c=userPanel.getUsernameById(b);c.done(function(a){a=$.parseJSON(a),$(userPanel.elements.posts.username).val(a.display_name)}),$(userPanel.elements.modals.postsRemove).modal("show")}),$(this.hooks.listing.userBan).click(function(a){var b=$(a.target).parent().parent().parent().attr("rt-data"),c=userPanel.getUsernameById(b);c.done(function(a){a=$.parseJSON(a),$(userPanel.elements.ban.username).val(a.display_name)}),$(userPanel.elements.modals.ban).modal("show")}),$(this.hooks.listing.userBanPermanent).click(function(){$(userPanel.elements.modals.ipBan).modal("show")}),$(this.hooks.listing.userMute).click(function(a){var b=$(a.target).parent().parent().parent().attr("rt-data"),c=userPanel.getUsernameById(b);c.done(function(a){a=$.parseJSON(a),$(userPanel.elements.mute.username).val(a.display_name)}),$(userPanel.elements.modals.mute).modal("show")})},a.prototype.awardSubmit=function(){var a=$(this.elements.award.id).val(),b=$(this.elements.award.username).val();if(0===b.length)return this.error("You must fill out the username field.");var c={id:a,username:b},d=utilities.postAJAX(this.paths.award,c);d.done(function(a){a=$.parseJSON(a),a.done===!0?userPanel.done("The award "+a.name+" has been adding to the account <b>"+a.user+"</b>."):userPanel.error("There was an unknown error while adding an award to that user's account.")})},a.prototype.banIpSubmit=function(){var a=$(this.elements.banIp.address).val(),b=$(this.elements.banIp.reason).val();if(a.length<=7)return this.error("The IP is not valid.");var c={ip:a,reason:b},d=utilities.postAJAX(this.paths.ip,c);d.done(function(a){a=$.parseJSON(a),a.done===!0?userPanel.done("The IP "+a.ip_address+" was successfully banned."):userPanel.error("There was an unknown error banning the IP "+a.ip_address)})},a.prototype.chatboxSubmit=function(){var a=$(this.elements.chatbox.username).val(),b=$(this.elements.chatbox.reason).val();if(0===a.length)return this.error("The username field must be completed.");var c={username:a,reason:b},d=utilities.postAJAX(this.paths.chatboxRemove,c);d.done(function(a){a=$.parseJSON(a),a.done===!0?userPanel.done("The chatbox messages by "+a.name+" have successfully been hidden."):userPanel.error("There was an unknown error.")})},a.prototype.done=function(a){$.each(this.elements.modals,function(){$(this).modal("hide")}),$(this.elements.modalResults.good).modal("show"),$(this.hooks.modals.results.good).html(a)},a.prototype.error=function(a){$.each(this.elements.modals,function(a,b){$(b).modal("hide")}),$(this.elements.modalResults.bad).modal("show"),$(this.hooks.modals.results.bad).html(a)},a.prototype.getAwards=function(){var a=utilities.getAJAX(this.paths.awardList);a.done(function(a){a=$.parseJSON(a),$.each(a,function(a,b){var c="<option value='"+b.id+"'>"+b.name+"</option";$(userPanel.elements.award.id).append(c)}),$(userPanel.elements.award.id).children().first().attr("selected","selected")})},a.prototype.getUsernameById=function(a){var b={id:a};return utilities.postAJAX(this.paths.username,b)},a.prototype.muteSubmit=function(){var a=$(this.elements.mute.username).val(),b=$(this.elements.mute.time).val(),c=$(this.elements.mute.reason).val();if(0===a.length||0===b.length||0===c.length)return this.error("All of the fields are required.");var d={username:a,time:b,reason:c},e=utilities.postAJAX(this.paths.mute,d);e.done(function(a){a=$.parseJSON(a),a.done===!0?userPanel.done("The user "+a.name+" has been successfully muted."):userPanel.error(-1===a.error?"That user does not exist.":-2===a.error?"There was an unknown error while muting that user.":-3===a.error?"You did not write a 'infinite' but did not write a number either.":"There was an unknown error while muting that user.")})},a.prototype.postsSubmit=function(){var a=$(this.elements.posts.username).val(),b=$(this.elements.posts.reason).val(),c={username:a,reason:b},d=utilities.postAJAX(this.paths.posts,c);d.done(function(a){a=$.parseJSON(a),a.done===!0?userPanel.done("The posts by "+a.name+" have been successfully hidden."):userPanel.error("There was an error while hiding the posts by "+a.name+".")})},a.prototype.search=function(){var a=$(this.elements.search.name).val();if(0===a.length)this.error("The name must be entered.");else{var b={name:a},c=utilities.postAJAX(this.paths.search,b);c.done(function(a){$("#admin-user-list").html(""),a=$.parseJSON(a),$.each(a,function(a,b){var c="<div class='col-xs-12 row'>";c+="<div class='col-xs-3 col-md-2 col-lg-1'>",c+="<img src='/img/forums/photos/"+b.id+".png' class='img-responsive img-center' />",c+="</div>",c+="<div class='col-xs-9 col-mg-10 col-lg-11'>",c+="<div class='clearfix'>",c+="<div class='pull-left'>",c+="<a href='/profile/"+b.id+"-user'>"+b.display_name+"</a>",c+="</div>",c+="<div class='pull-right'>",c+="<ul class='list-inline' rt-data='"+b.id+"'>",c+="<li><a rt-hook='admin.panel:user.posts.remove' title='Remove Forum Posts'><i class='fa fa-folder fa-2x text-warning'></i></a></li>",c+="<li><a rt-hook='admin.panel:user.chatbox.remove' title='Remove Chatbox Messages'><i class='fa fa-comments fa-2x text-warning'></i></a></li>",c+="<li><a rt-hook='admin.panel:user.mute' title='Mute User'><i class='fa fa-comments fa-2x holo-text-secondary'></i></a></li>",c+="<li><a rt-hook='admin.panel:user.ban' title='Ban User'><i class='fa fa-remove fa-2x text-warning'></i></a></li>",c+="<li><a rt-hook='admin.panel:user.ban.permanent' title='IP Ban User'><i class='fa fa-remove fa-2x text-danger'></i></a></li>",c+="<li><a rt-hook='admin.panel:user.award.add' title='Add Award'><i class='fa fa-thumbs-o-up fa-2x text-info'></i></a></li>",c+="<li><a href='/staff/administrator/users/"+b.id+"-view' title='Edit User'><i class='fa fa-search fa-2x text-info'></i></a></li>",c+="</div>",c+="</div>",c+="</div>",c+="</div>",$("#admin-user-list").append(c)}),userPanel.addEvents()})}},a}(),leaderPanel,LeaderPanel=function(){function a(){this.elements={},this.hooks={},this.paths={},this.elements={ban:{username:"#ban-username",reason:"#ban-reason"},modals:{ban:"#modal-temp-ban-user",chatbox:"#modal-clear-chatbox",demote:"#modal-demote-member",mute:"#modal-mute-user"},mute:{reason:"#mute-reason",time:"#mute-time",username:"#mute-username"},results:{good:"#modal-results-good",goodMessage:"[rt-hook='leader.panel:results.good.message']",bad:"#modal-results-bad",badMessage:"[rt-hook='leader.panel:results.bad.message']"}},this.hooks={ban:{submit:"[rt-hook='leader.panel:ban.submit']"},chatbox:{reason:"#chatbox-clear-reason",confirm:"[rt-hook='leader.panel:chatbox.clear']"},demote:{data:"[rt-hook='leader.panel:demote.data']"},mute:{submit:"[rt-hook='leader.panel:mute.submit']"}},this.paths={chatboxClear:"/staff/leader/clear-chatbox",demote:"/staff/leader/demote",mute:"/staff/leader/mute",ban:"/staff/leader/temp-ban"},this.setup()}return a.prototype.ban=function(){var a=$(this.elements.ban.username).val(),b=$(this.elements.ban.reason).val();if(a.length>0&&b.length>0){var c={username:a,reason:b},d=utilities.postAJAX(this.paths.ban,c);d.done(function(a){a=$.parseJSON(a),a.done===!0?leaderPanel.done("The user "+a.name+" was successfully temporarily banned."):leaderPanel.error(-1===a.error?"That user does not exist.":"An unknown error occurred.")})}else this.error("All fields need to be completed.")},a.prototype.chatboxClear=function(){var a=$(this.hooks.chatbox.reason).val();if(a.length<1)this.error("No reason was given.");else{var b={reason:a},c=utilities.postAJAX(this.paths.chatboxClear,b);c.done(function(a){a=$.parseJSON(a),a.done===!0?leaderPanel.done("The chatbox has been successfully cleared."):leaderPanel.error(-1===a.error?"There was an unknown error while setting all chat messages to invisible.":"There was an unknown error while clearing the chatbox.")})}},a.prototype.demote=function(a){var b=$(a.target).attr("rt-data"),c={id:b},d=utilities.postAJAX(this.paths.demote,c);d.done(function(a){a=$.parseJSON(a),leaderPanel.done(a.done===!0?"The user "+a.name+" was successfully demoted.":-1===a.error?"You are not a team leader and can not demote members.":-2===a.error?"That user is not in your team.":"There was unknown error.")})},a.prototype.done=function(a){$.each(this.elements.modals,function(a,b){$(b).modal("hide")}),$(this.elements.results.good).modal("show"),$(this.elements.results.goodMessage).html(a)},a.prototype.error=function(a){$.each(this.elements.modals,function(a,b){$(b).modal("hide")}),$(this.elements.results.bad).modal("show"),$(this.elements.results.badMessage).html(a)},a.prototype.mute=function(){var a=$(this.elements.mute.username).val(),b=$(this.elements.mute.time).val(),c=$(this.elements.mute.reason).val();if(a.length>0&&b.length>0&&c.length>0){var d={username:a,time:b,reason:c},e=utilities.postAJAX(this.paths.mute,d);e.done(function(a){a=$.parseJSON(a),a.done===!0?leaderPanel.done("The user "+a.name+" has been successfully muted."):leaderPanel.error(-1===a.error?"That user does not exist.":-2===a.error?"There was an unknown error while muting that user.":-3===a.error?"You did not write a 'infinite' but did not write a number either.":"There was an unknown error while muting that user.")})}else leaderPanel.error("All of the fields need to be completed.")},a.prototype.setup=function(){$(this.hooks.chatbox.confirm).click(function(){leaderPanel.chatboxClear()}),$(this.hooks.demote.data).click(function(a){leaderPanel.demote(a)}),$(this.hooks.mute.submit).click(function(){leaderPanel.mute()}),$(this.hooks.ban.submit).click(function(){leaderPanel.ban()})},a}(),RadioPanel=function(){function a(){this.live=null,this.timetable=null}return a}(),RadioPanelTimetable=function(){function a(){this.paths={},this.paths={claim:"/staff/radio/timetable"},$("[rt-data='radio.panel.timetable:update.hour']").bind("click",function(a){radioPanel.timetable.claim(a)})}return a.prototype.claim=function(a){var b=$(a.target).attr("rt-data2"),c=b.split(":"),d=c[0],e=b[1],f={day:d,hour:e},g=utilities.postAJAX(this.paths.claim,f);g.done(function(a){a=$.parseJSON(a),a.valid===!0?$("[rt-data2='"+a.day+":"+a.hour+"']").html(a.name):console.log("error")})},a}(),RadioPanelLive=function(){function a(){this.elements={},this.hooks={},this.paths={},this.elements={song:"[rt-data='radio.panel:current.song']",songName:"[rt-data='radio.panel:current.song.name']",songArtist:"[rt-data='radio.panel:current.song.artist']",currentMessage:"[rt-data='radio.panel:current.message']",requests:"[rt-data='radio.panel:requests']"},this.hooks={accept:"[rt-hook='radio.panel:request.accept']",decline:"[rt-hook='radio.panel:request.decline']"},this.paths={message:"/staff/radio/live/message",request:"/staff/radio/live/request",update:"/staff/radio/live/update"},this.update(),$("[rt-data='radio.panel:message.update']").bind("click",function(a){radioPanel.live.updateMessage($(a.target).attr("rt-data2"))})}return a.prototype.accept=function(a){var b={id:a,status:1},c=utilities.postAJAX(this.paths.request,b);c.done(function(a){a=$.parseJSON(a),a.done===!0?radioPanel.live.update():console.log("error")})},a.prototype.decline=function(a){var b={id:a,status:2},c=utilities.postAJAX(this.paths.request,b);c.done(function(a){a=$.parseJSON(a),a.done===!0?radioPanel.live.update():console.log("error")})},a.prototype.update=function(){var a=utilities.getAJAX(this.paths.update);a.done(function(a){a=$.parseJSON(a),$(radioPanel.live.elements.songName).html(a.song.name),$(radioPanel.live.elements.songArtist).html(a.song.artist),$(radioPanel.live.elements.currentMessage).html(a.song.message);var b="";$.each(a.requests,function(a,c){0===c.status?(b+="<p title='"+c.author_name+"' rt-data='"+c.id+"'>",b+="<a class='fa fa-check text-success' rt-hook='radio.panel:request.accept'></a>",b+="<a class='fa fa-close text-danger' rt-hook='radio.panel:request.decline'></a>"):1===c.status?b+="<p class='text-success' title='"+c.author_name+"'>":2===c.status&&(b+="<p class='text-danger' title='"+c.author_name+"'>"),b+=c.song_name,b+=" - ",b+=c.song_artist}),$(radioPanel.live.elements.requests).html(b),$(radioPanel.live.hooks.accept).click(function(a){var b=$(a.target).parent().attr("rt-data");radioPanel.live.accept(b)}),$(radioPanel.live.hooks.decline).click(function(a){var b=$(a.target).parent().attr("rt-data");radioPanel.live.decline(b)})}),setTimeout(function(){radioPanel.live.update()},3e4)},a.prototype.updateMessage=function(a){var b={id:a},c=utilities.postAJAX(this.paths.message,b);c.done(function(a){a=$.parseJSON(a),$(radioPanel.live.elements.currentMessage).html(a.message)})},a}(),radioPanel=new RadioPanel,staffPanel,StaffPanel=function(){function a(){this.hooks={},this.paths={},this.hooks={mute:{username:"#mute-username",reason:"#mute-contents",send:"[rt-hook='staff.panel:mute.send']"},report:{username:"#report-username",reason:"#report-contents",send:"[rt-hook='staff.panel:report.send']"},results:{good:"[rt-hook='staff.panel:results.good.message']",bad:"[rt-hook='staff.panel:results.bad.message']"}},this.paths={mute:"/staff/mute",report:"/staff/report"},$(this.hooks.mute.send).click(function(){staffPanel.sendMute()}),$(this.hooks.report.send).click(function(){staffPanel.sendReport()}),this.setup()}return a.prototype.error=function(){$(staffPanel.hooks.results.bad).html(-1===results.error?"That user does not exist.":-2===results.error?"There was an error with processing the report.":"There was an unknown error."),$("#modal-results-bad").modal("show")},a.prototype.sendMute=function(){var a={username:$(this.hooks.mute.username).val(),contents:$(this.hooks.mute.reason).val()},b=utilities.postAJAX(this.paths.mute,a);b.done(function(a){a=$.parseJSON(a),$("#modal-mute-user").modal("hide"),a.done===!0?$("#modal-results-good").modal("show"):staffPanel.error(a.error)})},a.prototype.sendReport=function(){var a={username:$(this.hooks.report.username).val(),contents:$(this.hooks.report.reason).val()},b=utilities.postAJAX(this.paths.report,a);b.done(function(a){a=$.parseJSON(a),$("#modal-report-user").modal("hide"),a.done===!0?$("#modal-results-good").modal("show"):staffPanel.error(a.error)})},a.prototype.setup=function(){var a=$(".pretty-row > div"),b=$(a).size();for(i=1;b>=i;i+=2){var c=$(".pretty-row div:nth-child("+i+")"),d=$(".pretty-row div:nth-child("+(i+1)+")"),e=Math.max($(c).height(),$(d).height());$(c).height(e),$(d).height(e)}if(b%2==0){var c=$(".pretty-row div:nth-child("+(b-1)+")"),d=$(".pretty-row div:nth-child("+b+")");$(c).css({"padding-bottom":0}),$(d).css({"padding-bottom":0})}else{var c=$(".pretty-row div:nth-child("+b+")");$(c).css({"padding-bottom":0})}},a}();