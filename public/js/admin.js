var adminPanel,AdminPanel=function(){function e(){this.elements={},this.hooks={},this.paths={},this.elements={ipBan:{ip:"#ip-ban-address",reason:"#ip-ban-reason"},modals:{chatboxClear:"#modal-chatbox-clear",ipBan:"#modal-ip-ban",radioStop:"#modal-radio-stop",staffDemote:"#modal-staff-demote"},results:{good:"#modal-results-good",goodMessage:"[rt-hook='modal:good.message']",bad:"#modal-results-bad",badMessage:"[rt-hook='modal:bad.message']"}},this.hooks={chatbox:{clear:{confirm:"[rt-hook='admin.panel:chatbox.clear.confirm']",open:"[rt-hook='admin.panel:chatbox.clear.open']"}},ip:{ban:{confirm:"[rt-hook='admin.panel:ip.ban.confirm']",open:"[rt-hook='admin.panel:ip.ban.open']"}},radio:{stop:{confirm:"[rt-hook='admin.panel:radio.stop.confirm']",open:"[rt-hook='admin.panel:radio.stop.open']"}},staff:{demote:{confirm:"[rt-hook='admin.panel:staff.demote.confirm']",open:"[rt-hook='admin.panel:staff.demote.open']"}}},this.paths={chatbox:{clear:"/staff/leader/chatbox-clear"},ip:{ban:"/staff/administrator/ip-ban"},radio:{stop:"/staff/administrator/radio-stop"},staff:{demote:"/staff/administrator/staff-demote"}},$(this.hooks.chatbox.clear.open).click(function(){$(adminPanel.elements.modals.chatboxClear).modal("show")}),$(this.hooks.ip.ban.open).click(function(){$(adminPanel.elements.modals.ipBan).modal("show")}),$(this.hooks.radio.stop.open).click(function(){$(adminPanel.elements.modals.radioStop).modal("show")}),$(this.hooks.staff.demote.open).click(function(){$(adminPanel.elements.modals.staffDemote).modal("show")}),$(this.hooks.chatbox.clear.confirm).click(function(){adminPanel.chatboxClear()}),$(this.hooks.ip.ban.confirm).click(function(){adminPanel.ban()}),$(this.hooks.radio.stop.confirm).click(function(){adminPanel.radioStop()}),$(this.hooks.staff.demote.confirm).click(function(){adminPanel.staffDemote()})}return e.prototype.ban=function(){var e=$(this.elements.ipBan.ip).val(),t=$(this.elements.ipBan.reason).val(),a={ip:e,contents:t},s=utilities.postAJAX(this.paths.ip.ban,a);s.done(function(e){e=$.parseJSON(e),e.done===!0?adminPanel.done("The IP has been successfully banned."):adminPanel.error("There was an unknown error while performing the IP ban.")})},e.prototype.chatboxClear=function(){var e=utilities.postAJAX(this.paths.chatbox.clear,{});e.done(function(e){e=$.parseJSON(e),e.done===!0?adminPanel.done("The chatbox was successfully cleared."):adminPanel.error("There was an unknown error while clearing the chatbox.")})},e.prototype.done=function(e){$.each(this.elements.modals,function(e,t){$(t).modal("hide")}),$(this.elements.results.good).modal("show"),$(this.elements.results.goodMessage).html(e)},e.prototype.error=function(e){$.each(this.elements.modals,function(e,t){$(t).modal("hide")}),$(this.elements.results.bad).modal("show"),$(this.elements.results.badMessage).html(e)},e.prototype.radioStop=function(){var e=utilities.postAJAX(this.paths.radio.stop,{});e.done(function(e){e=$.parseJSON(e),e.done===!0?adminPanel.done("The radio will successfully stop within 30 seconds."):adminPanel.error("The radio has been switched on.")})},e.prototype.staffDemote=function(){var e=utilities.postAJAX(this.paths.staff.demote,{});e.done(function(e){e=$.parseJSON(e),e.done===!0?adminPanel.done("All staff were successfully demoted."):adminPanel.error("There was an unknown error while demoting all staff.")})},e}(),userPanel,AdminUserPanel=function(){function e(){this.elements={},this.hooks={},this.paths={},this.elements={award:{id:"#award-add-id",username:"#award-add-username"},ban:{},banIp:{address:"#ip-ban-address",reason:"#ip-ban-reason"},chatbox:{reason:"#chatbox-remove-reason",username:"#chatbox-remove-username"},modals:{award:"#modal-award-add",ban:"#modal-ban",chatboxRemove:"#modal-chatbox-remove",ipBan:"#modal-ip-ban",mute:"#modal-mute-user",postsRemove:"#modal-posts-remove"},modalResults:{bad:"#modal-results-bad",good:"#modal-results-good"},mute:{reason:"#mute-reason",time:"#mute-time",username:"#mute-username"},posts:{reason:"#posts-remove-reason",username:"#posts-remove-username"},search:{list:"#admin-user-list",name:"#admin-user-search"}},this.hooks={listing:{awardAdd:"[rt-hook='admin.panel:user.award.add']",chatboxRemove:"[rt-hook='admin.panel:user.chatbox.remove']",postsRemove:"[rt-hook='admin.panel:user.posts.remove']",userBan:"[rt-hook='admin.panel:user.ban']",userBanPermanent:"[rt-hook='admin.panel:user.ban.permanent']",userMute:"[rt-hook='admin.panel:user.mute']"},modals:{results:{bad:"[rt-hook='modal:bad.message']",good:"[rt-hook='modal:good.message']"}},search:{submit:"[rt-hook='admin.panel:user.search']",submitAll:"[rt-hook='admin.panel:user.search.all']"},submit:{award:"[rt-hook='admin.panel:user.award.add.confirm']",chatbox:"[rt-hook='admin.panel:user.chatbox.remove.confirm']",ip:"[rt-hook='admin.panel:ip.ban.confirm']",mute:"[rt-hook='leader.panel:mute.submit']",posts:"[rt-hook='admin.panel:user.posts.remove.confirm']"}},this.paths={award:"/staff/administrator/users/award-add",awardList:"/api/v1/awards",chatboxRemove:"/staff/administrator/users/chatbox-remove",ip:"/staff/administrator/ip-ban",mute:"/staff/leader/mute",posts:"/staff/administrator/users/forum-posts",search:"/staff/administrator/users/search",searchAll:"/staff/administrator/users/search-all",username:"/api/v1/user"},$(this.hooks.search.submit).click(function(){userPanel.search()}),$(this.hooks.search.submitAll).click(function(){userPanel.searchAll()}),$(this.hooks.submit.award).click(function(){userPanel.awardSubmit()}),$(this.hooks.submit.chatbox).click(function(){userPanel.chatboxSubmit()}),$(this.hooks.submit.ip).click(function(){userPanel.banIpSubmit()}),$(this.hooks.submit.posts).click(function(){userPanel.postsSubmit()}),$(this.hooks.submit.mute).click(function(){userPanel.muteSubmit()})}return e.prototype.addEvents=function(){$(this.hooks.listing.awardAdd).click(function(e){var t=$(e.target).parent().parent().parent().attr("rt-data"),a=userPanel.getUsernameById(t);a.done(function(e){e=$.parseJSON(e),$(userPanel.elements.award.username).val(e.display_name)}),userPanel.getAwards(),$(userPanel.elements.modals.award).modal("show")}),$(this.hooks.listing.chatboxRemove).click(function(e){var t=$(e.target).parent().parent().parent().attr("rt-data"),a=userPanel.getUsernameById(t);a.done(function(e){e=$.parseJSON(e),$(userPanel.elements.chatbox.username).val(e.display_name)}),$(userPanel.elements.modals.chatboxRemove).modal("show")}),$(this.hooks.listing.postsRemove).click(function(e){var t=$(e.target).parent().parent().parent().attr("rt-data"),a=userPanel.getUsernameById(t);a.done(function(e){e=$.parseJSON(e),$(userPanel.elements.posts.username).val(e.display_name)}),$(userPanel.elements.modals.postsRemove).modal("show")}),$(this.hooks.listing.userBan).click(function(e){var t=$(e.target).parent().parent().parent().attr("rt-data"),a=userPanel.getUsernameById(t);a.done(function(e){e=$.parseJSON(e),$(userPanel.elements.ban.username).val(e.display_name)}),$(userPanel.elements.modals.ban).modal("show")}),$(this.hooks.listing.userBanPermanent).click(function(e){$(userPanel.elements.modals.ipBan).modal("show")}),$(this.hooks.listing.userMute).click(function(e){var t=$(e.target).parent().parent().parent().attr("rt-data"),a=userPanel.getUsernameById(t);a.done(function(e){e=$.parseJSON(e),$(userPanel.elements.mute.username).val(e.display_name)}),$(userPanel.elements.modals.mute).modal("show")})},e.prototype.awardSubmit=function(){var e=$(this.elements.award.id).val(),t=$(this.elements.award.username).val();if(0===t.length)return this.error("You must fill out the username field.");var a={id:e,username:t},s=utilities.postAJAX(this.paths.award,a);s.done(function(e){e=$.parseJSON(e),e.done===!0?userPanel.done("The award "+e.name+" has been adding to the account <b>"+e.user+"</b>."):userPanel.error("There was an unknown error while adding an award to that user's account.")})},e.prototype.banIpSubmit=function(){var e=$(this.elements.banIp.address).val(),t=$(this.elements.banIp.reason).val();if(e.length<=7)return this.error("The IP is not valid.");var a={ip:e,reason:t},s=utilities.postAJAX(this.paths.ip,a);s.done(function(e){e=$.parseJSON(e),e.done===!0?userPanel.done("The IP "+e.ip_address+" was successfully banned."):userPanel.error("There was an unknown error banning the IP "+e.ip_address)})},e.prototype.chatboxSubmit=function(){var e=$(this.elements.chatbox.username).val(),t=$(this.elements.chatbox.reason).val();if(0===e.length)return this.error("The username field must be completed.");var a={username:e,reason:t},s=utilities.postAJAX(this.paths.chatboxRemove,a);s.done(function(e){e=$.parseJSON(e),e.done===!0?userPanel.done("The chatbox messages by "+e.name+" have successfully been hidden."):userPanel.error("There was an unknown error.")})},e.prototype.done=function(e){$.each(this.elements.modals,function(){$(this).modal("hide")}),$(this.elements.modalResults.good).modal("show"),$(this.hooks.modals.results.good).html(e)},e.prototype.error=function(e){$.each(this.elements.modals,function(e,t){$(t).modal("hide")}),$(this.elements.modalResults.bad).modal("show"),$(this.hooks.modals.results.bad).html(e)},e.prototype.getAwards=function(){var e=utilities.getAJAX(this.paths.awardList);e.done(function(e){e=$.parseJSON(e),$.each(e,function(e,t){var a="<option value='"+t.id+"'>"+t.name+"</option";$(userPanel.elements.award.id).append(a)}),$(userPanel.elements.award.id).children().first().attr("selected","selected")})},e.prototype.getUsernameById=function(e){var t={id:e};return utilities.postAJAX(this.paths.username,t)},e.prototype.muteSubmit=function(){var e=$(this.elements.mute.username).val(),t=$(this.elements.mute.time).val(),a=$(this.elements.mute.reason).val();if(0===e.length||0===t.length||0===a.length)return this.error("All of the fields are required.");var s={username:e,time:t,reason:a},o=utilities.postAJAX(this.paths.mute,s);o.done(function(e){e=$.parseJSON(e),e.done===!0?userPanel.done("The user "+e.name+" has been successfully muted."):userPanel.error(-1===e.error?"That user does not exist.":-2===e.error?"There was an unknown error while muting that user.":-3===e.error?"You did not write a 'infinite' but did not write a number either.":"There was an unknown error while muting that user.")})},e.prototype.postsSubmit=function(){var e=$(this.elements.posts.username).val(),t=$(this.elements.posts.reason).val(),a={username:e,reason:t},s=utilities.postAJAX(this.paths.posts,a);s.done(function(e){e=$.parseJSON(e),e.done===!0?userPanel.done("The posts by "+e.name+" have been successfully hidden."):userPanel.error("There was an error while hiding the posts by "+e.name+".")})},e.prototype.search=function(){var e=$(this.elements.search.name).val();if(0===e.length)this.error("The name must be entered.");else{var t={name:e},a=utilities.postAJAX(this.paths.search,t),s=this;a.done(function(e){$("#admin-user-list").html(""),e=$.parseJSON(e),$.each(e,function(e,t){var a=s.result(t);$("#admin-user-list").append(a)}),userPanel.addEvents()})}},e.prototype.searchAll=function(){var e=utilities.getAJAX(this.paths.searchAll),t=this;e.done(function(e){$("#admin-user-list").html(""),e=$.parseJSON(e),$.each(e,function(e,a){var s=t.result(a);$("#admin-user-list").append(s)}),userPanel.addEvents()})},e.prototype.result=function(e){var t="<div class='col-xs-12 row'>";return t+="<div class='col-xs-3 col-md-2 col-lg-1'>",t+="<img src='/img/forums/photos/"+e.id+".png' class='img-responsive img-center' />",t+="</div>",t+="<div class='col-xs-9 col-mg-10 col-lg-11'>",t+="<div class='clearfix'>",t+="<div class='pull-left'>",t+="<a href='/profile/"+e.id+"-user'>"+e.display_name+"</a>",t+="</div>",t+="<div class='pull-right'>",t+="<ul class='list-inline' rt-data='"+e.id+"'>",t+="<li><a rt-hook='admin.panel:user.posts.remove' title='Remove Forum Posts'><i class='fa fa-folder fa-2x text-warning'></i></a></li>",t+="<li><a rt-hook='admin.panel:user.chatbox.remove' title='Remove Chatbox Messages'><i class='fa fa-comments fa-2x text-warning'></i></a></li>",t+="<li><a rt-hook='admin.panel:user.mute' title='Mute User'><i class='fa fa-comments fa-2x holo-text-secondary'></i></a></li>",t+="<li><a rt-hook='admin.panel:user.ban' title='Ban User'><i class='fa fa-remove fa-2x text-warning'></i></a></li>",t+="<li><a rt-hook='admin.panel:user.ban.permanent' title='IP Ban User'><i class='fa fa-remove fa-2x text-danger'></i></a></li>",t+="<li><a rt-hook='admin.panel:user.award.add' title='Add Award'><i class='fa fa-thumbs-o-up fa-2x text-info'></i></a></li>",t+="<li><a href='/staff/administrator/users/"+e.id+"-view' title='Edit User'><i class='fa fa-search fa-2x text-info'></i></a></li>",t+="</div>",t+="</div>",t+="</div>",t+="</div>"},e}(),leaderPanel,LeaderPanel=function(){function e(){this.elements={},this.hooks={},this.paths={},this.elements={ban:{username:"#ban-username",reason:"#ban-reason"},modals:{ban:"#modal-temp-ban-user",chatbox:"#modal-clear-chatbox",demote:"#modal-demote-member",mute:"#modal-mute-user"},mute:{reason:"#mute-reason",time:"#mute-time",username:"#mute-username"},results:{good:"#modal-results-good",goodMessage:"[rt-hook='leader.panel:results.good.message']",bad:"#modal-results-bad",badMessage:"[rt-hook='leader.panel:results.bad.message']"}},this.hooks={ban:{submit:"[rt-hook='leader.panel:ban.submit']"},chatbox:{reason:"#chatbox-clear-reason",confirm:"[rt-hook='leader.panel:chatbox.clear']"},demote:{data:"[rt-hook='leader.panel:demote.data']"},mute:{submit:"[rt-hook='leader.panel:mute.submit']"}},this.paths={chatboxClear:"/staff/leader/clear-chatbox",demote:"/staff/leader/demote",mute:"/staff/leader/mute",ban:"/staff/leader/temp-ban"},this.setup()}return e.prototype.ban=function(){var e=$(this.elements.ban.username).val(),t=$(this.elements.ban.reason).val();if(e.length>0&&t.length>0){var a={username:e,reason:t},s=utilities.postAJAX(this.paths.ban,a);s.done(function(e){e=$.parseJSON(e),e.done===!0?leaderPanel.done("The user "+e.name+" was successfully temporarily banned."):leaderPanel.error(-1===e.error?"That user does not exist.":"An unknown error occurred.")})}else this.error("All fields need to be completed.")},e.prototype.chatboxClear=function(){var e=$(this.hooks.chatbox.reason).val();if(e.length<1)this.error("No reason was given.");else{var t={reason:e},a=utilities.postAJAX(this.paths.chatboxClear,t);a.done(function(e){e=$.parseJSON(e),e.done===!0?leaderPanel.done("The chatbox has been successfully cleared."):leaderPanel.error(-1===e.error?"There was an unknown error while setting all chat messages to invisible.":"There was an unknown error while clearing the chatbox.")})}},e.prototype.demote=function(e){var t=$(e.target).attr("rt-data"),a={id:t},s=utilities.postAJAX(this.paths.demote,a);s.done(function(e){e=$.parseJSON(e),leaderPanel.done(e.done===!0?"The user "+e.name+" was successfully demoted.":-1===e.error?"You are not a team leader and can not demote members.":-2===e.error?"That user is not in your team.":"There was unknown error.")})},e.prototype.done=function(e){$.each(this.elements.modals,function(e,t){$(t).modal("hide")}),$(this.elements.results.good).modal("show"),$(this.elements.results.goodMessage).html(e)},e.prototype.error=function(e){$.each(this.elements.modals,function(e,t){$(t).modal("hide")}),$(this.elements.results.bad).modal("show"),$(this.elements.results.badMessage).html(e)},e.prototype.mute=function(){var e=$(this.elements.mute.username).val(),t=$(this.elements.mute.time).val(),a=$(this.elements.mute.reason).val();if(e.length>0&&t.length>0&&a.length>0){var s={username:e,time:t,reason:a},o=utilities.postAJAX(this.paths.mute,s);o.done(function(e){e=$.parseJSON(e),e.done===!0?leaderPanel.done("The user "+e.name+" has been successfully muted."):leaderPanel.error(-1===e.error?"That user does not exist.":-2===e.error?"There was an unknown error while muting that user.":-3===e.error?"You did not write a 'infinite' but did not write a number either.":"There was an unknown error while muting that user.")})}else leaderPanel.error("All of the fields need to be completed.")},e.prototype.setup=function(){$(this.hooks.chatbox.confirm).click(function(){leaderPanel.chatboxClear()}),$(this.hooks.demote.data).click(function(e){leaderPanel.demote(e)}),$(this.hooks.mute.submit).click(function(){leaderPanel.mute()}),$(this.hooks.ban.submit).click(function(){leaderPanel.ban()})},e}(),RadioPanel=function(){function e(){this.live=null,this.timetable=null}return e}(),RadioPanelTimetable=function(){function e(){this.paths={},this.paths={claim:"/staff/radio/timetable"},$("[rt-data='radio.panel.timetable:update.hour']").bind("click",function(e){radioPanel.timetable.claim(e)})}return e.prototype.claim=function(e){var t=$(e.target).attr("rt-data2"),a=t.split(":"),s=a[0],o=a[1],n={day:s,hour:o},r=utilities.postAJAX(this.paths.claim,n);r.done(function(e){e=$.parseJSON(e),e.valid===!0?(console.log(e),$("[rt-data2='"+e.day+":"+e.hour+"']").html(e.name)):console.log("error")})},e}(),RadioPanelLive=function(){function e(){this.elements={},this.hooks={},this.paths={},this.elements={song:"[rt-data='radio.panel:current.song']",songName:"[rt-data='radio.panel:current.song.name']",songArtist:"[rt-data='radio.panel:current.song.artist']",currentMessage:"[rt-data='radio.panel:current.message']",requests:"[rt-data='radio.panel:requests']"},this.hooks={accept:"[rt-hook='radio.panel:request.accept']",decline:"[rt-hook='radio.panel:request.decline']"},this.paths={message:"/staff/radio/live/message",request:"/staff/radio/live/request",update:"/staff/radio/live/update"},this.update(),$("[rt-data='radio.panel:message.update']").bind("click",function(e){radioPanel.live.updateMessage($(e.target).attr("rt-data2"))})}return e.prototype.accept=function(e){var t={id:e,status:1},a=utilities.postAJAX(this.paths.request,t);a.done(function(e){e=$.parseJSON(e),e.done===!0?radioPanel.live.update():console.log("error")})},e.prototype.decline=function(e){var t={id:e,status:2},a=utilities.postAJAX(this.paths.request,t);a.done(function(e){e=$.parseJSON(e),e.done===!0?radioPanel.live.update():console.log("error")})},e.prototype.update=function(){var e=utilities.getAJAX(this.paths.update),t=this;e.done(function(e){e=$.parseJSON(e),$(t.elements.songName).html(e.song.name),$(t.elements.songArtist).html(e.song.artist),$(t.elements.currentMessage).html(e.message);var a="";$.each(e.requests,function(e,t){0===t.status?(a+="<p title='"+t.author_name+"' rt-data='"+t.id+"'>",a+="<a class='fa fa-check text-success' rt-hook='radio.panel:request.accept'></a>",a+="<a class='fa fa-close text-danger' rt-hook='radio.panel:request.decline'></a>"):1===t.status?a+="<p class='text-success' title='"+t.author_name+"'>":2===t.status&&(a+="<p class='text-danger' title='"+t.author_name+"'>"),a+=t.song_name,a+=" - ",a+=t.song_artist}),$(radioPanel.live.elements.requests).html(a),$(radioPanel.live.hooks.accept).click(function(e){var t=$(e.target).parent().attr("rt-data");radioPanel.live.accept(t)}),$(radioPanel.live.hooks.decline).click(function(e){var t=$(e.target).parent().attr("rt-data");radioPanel.live.decline(t)})}),setTimeout(function(){radioPanel.live.update()},3e4)},e.prototype.updateMessage=function(e){var t={id:e},a=utilities.postAJAX(this.paths.message,t);a.done(function(e){e=$.parseJSON(e),$(radioPanel.live.elements.currentMessage).html(e.message)})},e}(),radioPanel=new RadioPanel,staffPanel,StaffPanel=function(){function e(){this.hooks={},this.paths={},this.hooks={mute:{username:"#mute-username",reason:"#mute-contents",send:"[rt-hook='staff.panel:mute.send']"},report:{username:"#report-username",reason:"#report-contents",send:"[rt-hook='staff.panel:report.send']"},results:{good:"[rt-hook='staff.panel:results.good.message']",bad:"[rt-hook='staff.panel:results.bad.message']"}},this.paths={mute:"/staff/mute",report:"/staff/report"},$(this.hooks.mute.send).click(function(e){staffPanel.sendMute()}),$(this.hooks.report.send).click(function(e){staffPanel.sendReport()}),this.setup()}return e.prototype.error=function(e){$(staffPanel.hooks.results.bad).html(-1===results.error?"That user does not exist.":-2===results.error?"There was an error with processing the report.":"There was an unknown error."),$("#modal-results-bad").modal("show")},e.prototype.sendMute=function(){var e={username:$(this.hooks.mute.username).val(),contents:$(this.hooks.mute.reason).val()},t=utilities.postAJAX(this.paths.mute,e);t.done(function(e){e=$.parseJSON(e),$("#modal-mute-user").modal("hide"),e.done===!0?$("#modal-results-good").modal("show"):staffPanel.error(e.error)})},e.prototype.sendReport=function(){var e={username:$(this.hooks.report.username).val(),contents:$(this.hooks.report.reason).val()},t=utilities.postAJAX(this.paths.report,e);t.done(function(e){e=$.parseJSON(e),$("#modal-report-user").modal("hide"),e.done===!0?$("#modal-results-good").modal("show"):staffPanel.error(e.error)})},e.prototype.setup=function(){var e=$(".pretty-row > div"),t=$(e).size();for(i=1;i<=t;i+=2){var a=$(".pretty-row div:nth-child("+i+")"),s=$(".pretty-row div:nth-child("+(i+1)+")"),o=Math.max($(a).height(),$(s).height());$(a).height(o),$(s).height(o)}if(t%2==0){var a=$(".pretty-row div:nth-child("+(t-1)+")"),s=$(".pretty-row div:nth-child("+t+")");$(a).css({"padding-bottom":0}),$(s).css({"padding-bottom":0})}else{var a=$(".pretty-row div:nth-child("+t+")");$(a).css({"padding-bottom":0})}},e}();